import{g as Je,c as N,e as K,r as Ye,d as $,u as Xe,a as l,m as G,n as R,t as Q,b as O,i as B,I as z,w as D,f as Qe,s as Ze,h as pe,j as et,k as tt,l as nt,o as at,p as L,q as oe,F as lt,v as I,x as j,y as ye,z as ot,C as it,A as ie,B as Y,D as Se,E as rt,G as ge,H as ct,J as st,K as ee,L as F,M as Ce,N as ut,O as dt,P as Ve,Q as ft,R as we,S as le,T as mt,U as gt,_ as bt,V as X,W as te,X as w,Y as be,Z as ht,$ as ne,a0 as he,a1 as vt,a2 as W,a3 as kt,a4 as _t,a5 as yt,a6 as St,a7 as Ct,a8 as Vt}from"./index-18b25ed7.js";import{k as wt,N as xt}from"./kana-13e22726.js";let It=0;function Tt(){const e=Je(),{name:n="unknown"}=(e==null?void 0:e.type)||{};return`${n}-${++It}`}const[Lt,A]=N("cell"),xe={tag:G("div"),icon:String,size:String,title:R,value:R,label:R,center:Boolean,isLink:Boolean,border:Q,iconPrefix:String,valueClass:O,labelClass:O,titleClass:O,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},Pt=K({},xe,Ye);var Et=$({name:Lt,props:Pt,setup(e,{slots:n}){const r=Xe(),a=()=>{if(n.label||B(e.label))return l("div",{class:[A("label"),e.labelClass]},[n.label?n.label():e.label])},i=()=>{var c;if(n.title||B(e.title)){const m=(c=n.title)==null?void 0:c.call(n);return Array.isArray(m)&&m.length===0?void 0:l("div",{class:[A("title"),e.titleClass],style:e.titleStyle},[m||l("span",null,[e.title]),a()])}},o=()=>{const c=n.value||n.default;if(c||B(e.value))return l("div",{class:[A("value"),e.valueClass]},[c?c():l("span",null,[e.value])])},b=()=>{if(n.icon)return n.icon();if(e.icon)return l(z,{name:e.icon,class:A("left-icon"),classPrefix:e.iconPrefix},null)},g=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const c=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return l(z,{name:c,class:A("right-icon")},null)}};return()=>{var c;const{tag:m,size:u,center:k,border:f,isLink:_,required:y}=e,S=(c=e.clickable)!=null?c:_,v={center:k,required:!!y,clickable:S,borderless:!f};return u&&(v[u]=!!u),l(m,{class:A(v),role:S?"button":void 0,tabindex:S?0:void 0,onClick:r},{default:()=>{var V;return[b(),i(),o(),g(),(V=n.extra)==null?void 0:V.call(n)]}})}}});const Ie=D(Et);function Te(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Bt(e,n){if(Te(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Rt(e,n){return new Promise(r=>{const a=n.validator(e,n);if(pe(a)){a.then(r);return}r(a)})}function ve(e,n){const{message:r}=n;return et(r)?r(e,n):r||""}function qt({target:e}){e.composing=!0}function ke({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Mt(e,n){const r=Qe();e.style.height="auto";let a=e.scrollHeight;if(tt(n)){const{maxHeight:i,minHeight:o}=n;i!==void 0&&(a=Math.min(a,i)),o!==void 0&&(a=Math.max(a,o))}a&&(e.style.height=`${a}px`,Ze(r))}function Ot(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function E(e){return[...e].length}function ae(e,n){return[...e].slice(0,n).join("")}const[Nt,x]=N("field"),$t={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:R,max:Number,min:Number,formatter:Function,clearIcon:G("clear"),modelValue:nt(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:G("focus"),formatTrigger:G("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},At=K({},xe,$t,{rows:R,type:G("text"),rules:Array,autosize:[Boolean,Object],labelWidth:R,labelClass:O,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var zt=$({name:Nt,props:At,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:r}){const a=Tt(),i=at({status:"unvalidated",focused:!1,validateMessage:""}),o=L(),b=L(),g=L(),{parent:c}=oe(lt),m=()=>{var t;return String((t=e.modelValue)!=null?t:"")},u=t=>{if(B(e[t]))return e[t];if(c&&B(c.props[t]))return c.props[t]},k=I(()=>{const t=u("readonly");if(e.clearable&&!t){const s=m()!=="",d=e.clearTrigger==="always"||e.clearTrigger==="focus"&&i.focused;return s&&d}return!1}),f=I(()=>g.value&&r.input?g.value():e.modelValue),_=I(()=>{var t;const s=u("required");return s==="auto"?(t=e.rules)==null?void 0:t.some(d=>d.required):s}),y=t=>t.reduce((s,d)=>s.then(()=>{if(i.status==="failed")return;let{value:h}=f;if(d.formatter&&(h=d.formatter(h,d)),!Bt(h,d)){i.status="failed",i.validateMessage=ve(h,d);return}if(d.validator)return Te(h)&&d.validateEmpty===!1?void 0:Rt(h,d).then(C=>{C&&typeof C=="string"?(i.status="failed",i.validateMessage=C):C===!1&&(i.status="failed",i.validateMessage=ve(h,d))})}),Promise.resolve()),S=()=>{i.status="unvalidated",i.validateMessage=""},v=()=>n("endValidate",{status:i.status,message:i.validateMessage}),V=(t=e.rules)=>new Promise(s=>{S(),t?(n("startValidate"),y(t).then(()=>{i.status==="failed"?(s({name:e.name,message:i.validateMessage}),v()):(i.status="passed",s(),v())})):s()}),Z=t=>{if(c&&e.rules){const{validateTrigger:s}=c.props,d=ge(s).includes(t),h=e.rules.filter(C=>C.trigger?ge(C.trigger).includes(t):d);h.length&&V(h)}},Be=t=>{var s;const{maxlength:d}=e;if(B(d)&&E(t)>+d){const h=m();if(h&&E(h)===+d)return h;const C=(s=o.value)==null?void 0:s.selectionEnd;if(i.focused&&C){const q=[...t],M=q.length-+d;return q.splice(C-M,M),q.join("")}return ae(t,+d)}return t},U=(t,s="onChange")=>{var d,h;const C=t;t=Be(t);const q=E(C)-E(t);if(e.type==="number"||e.type==="digit"){const T=e.type==="number";t=ct(t,T,T),s==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)&&(t=st(+t,(d=e.min)!=null?d:-1/0,(h=e.max)!=null?h:1/0).toString())}let M=0;if(e.formatter&&s===e.formatTrigger){const{formatter:T,maxlength:P}=e;if(t=T(t),B(P)&&E(t)>+P&&(t=ae(t,+P)),o.value&&i.focused){const{selectionEnd:J}=o.value,me=ae(C,J);M=E(T(me))-E(me)}}if(o.value&&o.value.value!==t)if(i.focused){let{selectionStart:T,selectionEnd:P}=o.value;if(o.value.value=t,B(T)&&B(P)){const J=E(t);q?(T-=q,P-=q):M&&(T+=M,P+=M),o.value.setSelectionRange(Math.min(T,J),Math.min(P,J))}}else o.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},Re=t=>{t.target.composing||U(t.target.value)},p=()=>{var t;return(t=o.value)==null?void 0:t.blur()},se=()=>{var t;return(t=o.value)==null?void 0:t.focus()},H=()=>{const t=o.value;e.type==="textarea"&&e.autosize&&t&&Mt(t,e.autosize)},qe=t=>{i.focused=!0,n("focus",t),Y(H),u("readonly")&&p()},Me=t=>{i.focused=!1,U(m(),"onBlur"),n("blur",t),!u("readonly")&&(Z("onBlur"),Y(H),ut())},ue=t=>n("clickInput",t),Oe=t=>n("clickLeftIcon",t),Ne=t=>n("clickRightIcon",t),$e=t=>{ee(t),n("update:modelValue",""),n("clear",t)},de=I(()=>{if(typeof e.error=="boolean")return e.error;if(c&&c.props.showError&&i.status==="failed")return!0}),Ae=I(()=>{const t=u("labelWidth"),s=u("labelAlign");if(t&&s!=="top")return{width:j(t)}}),ze=t=>{t.keyCode===13&&(!(c&&c.props.submitOnEnter)&&e.type!=="textarea"&&ee(t),e.type==="search"&&p()),n("keypress",t)},fe=()=>e.id||`${a}-input`,De=()=>i.status,Ge=()=>{const t=x("control",[u("inputAlign"),{error:de.value,custom:!!r.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(r.input)return l("div",{class:t,onClick:ue},[r.input()]);const s={id:fe(),ref:o,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:u("disabled"),readonly:u("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${a}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:Me,onFocus:qe,onInput:Re,onClick:ue,onChange:ke,onKeypress:ze,onCompositionend:ke,onCompositionstart:qt};return e.type==="textarea"?l("textarea",F(s,{inputmode:e.inputmode}),null):l("input",F(Ot(e.type,e.inputmode),s),null)},je=()=>{const t=r["left-icon"];if(e.leftIcon||t)return l("div",{class:x("left-icon"),onClick:Oe},[t?t():l(z,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Fe=()=>{const t=r["right-icon"];if(e.rightIcon||t)return l("div",{class:x("right-icon"),onClick:Ne},[t?t():l(z,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},We=()=>{if(e.showWordLimit&&e.maxlength){const t=E(m());return l("div",{class:x("word-limit")},[l("span",{class:x("word-num")},[t]),Ce("/"),e.maxlength])}},Ke=()=>{if(c&&c.props.showErrorMessage===!1)return;const t=e.errorMessage||i.validateMessage;if(t){const s=r["error-message"],d=u("errorMessageAlign");return l("div",{class:x("error-message",d)},[s?s({message:t}):t])}},Ue=()=>{const t=u("labelWidth"),s=u("labelAlign"),d=u("colon")?":":"";if(r.label)return[r.label(),d];if(e.label)return l("label",{id:`${a}-label`,for:r.input?void 0:fe(),"data-allow-mismatch":"attribute",onClick:h=>{ee(h),se()},style:s==="top"&&t?{width:j(t)}:void 0},[e.label+d])},He=()=>[l("div",{class:x("body")},[Ge(),k.value&&l(z,{ref:b,name:e.clearIcon,class:x("clear")},null),Fe(),r.button&&l("div",{class:x("button")},[r.button()])]),We(),Ke()];return ye({blur:p,focus:se,validate:V,formValue:f,resetValidation:S,getValidationStatus:De}),ot(it,{customValue:g,resetValidation:S,validateWithTrigger:Z}),ie(()=>e.modelValue,()=>{U(m()),S(),Z("onChange"),Y(H)}),Se(()=>{U(m(),e.formatTrigger),Y(H)}),rt("touchstart",$e,{target:I(()=>{var t;return(t=b.value)==null?void 0:t.$el})}),()=>{const t=u("disabled"),s=u("labelAlign"),d=je(),h=()=>{const C=Ue();return s==="top"?[d,C].filter(Boolean):C||[]};return l(Ie,{size:e.size,class:x({error:de.value,disabled:t,[`label-${s}`]:s}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Ae.value,valueClass:x("value"),titleClass:[x("label",[s,{required:_.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:d&&s!=="top"?()=>d:null,title:h,value:He,extra:r.extra})}}});const Dt=D(zt),[Le,Gt]=N("radio-group"),jt={shape:String,disabled:Boolean,iconSize:R,direction:String,modelValue:O,checkedColor:String},Pe=Symbol(Le);var Ft=$({name:Le,props:jt,emits:["change","update:modelValue"],setup(e,{emit:n,slots:r}){const{linkChildren:a}=dt(Pe),i=o=>n("update:modelValue",o);return ie(()=>e.modelValue,o=>n("change",o)),a({props:e,updateValue:i}),Ve(()=>e.modelValue),()=>{var o;return l("div",{class:Gt([e.direction]),role:"radiogroup"},[(o=r.default)==null?void 0:o.call(r)])}}});const Wt=D(Ft),[Kt,kn]=N("checkbox-group"),Ut=Symbol(Kt),re={name:O,disabled:Boolean,iconSize:R,modelValue:O,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var Ee=$({props:K({},re,{bem:ft(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:Q,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(e,{emit:n,slots:r}){const a=L(),i=f=>{if(e.parent&&e.bindGroup)return e.parent.props[f]},o=I(()=>{if(e.parent&&e.bindGroup){const f=i("disabled")||e.disabled;if(e.role==="checkbox"){const _=i("modelValue").length,y=i("max"),S=y&&_>=+y;return f||S&&!e.checked}return f}return e.disabled}),b=I(()=>i("direction")),g=I(()=>{const f=e.checkedColor||i("checkedColor");if(f&&e.checked&&!o.value)return{borderColor:f,backgroundColor:f}}),c=I(()=>e.shape||i("shape")||"round"),m=f=>{const{target:_}=f,y=a.value,S=y===_||(y==null?void 0:y.contains(_));!o.value&&(S||!e.labelDisabled)&&n("toggle"),n("click",f)},u=()=>{var f,_;const{bem:y,checked:S,indeterminate:v}=e,V=e.iconSize||i("iconSize");return l("div",{ref:a,class:y("icon",[c.value,{disabled:o.value,checked:S,indeterminate:v}]),style:c.value!=="dot"?{fontSize:j(V)}:{width:j(V),height:j(V),borderColor:(f=g.value)==null?void 0:f.borderColor}},[r.icon?r.icon({checked:S,disabled:o.value}):c.value!=="dot"?l(z,{name:v?"minus":"success",style:g.value},null):l("div",{class:y("icon--dot__icon"),style:{backgroundColor:(_=g.value)==null?void 0:_.backgroundColor}},null)])},k=()=>{const{checked:f}=e;if(r.default)return l("span",{class:e.bem("label",[e.labelPosition,{disabled:o.value}])},[r.default({checked:f,disabled:o.value})])};return()=>{const f=e.labelPosition==="left"?[k(),u()]:[u(),k()];return l("div",{role:e.role,class:e.bem([{disabled:o.value,"label-disabled":e.labelDisabled},b.value]),tabindex:o.value?void 0:0,"aria-checked":e.checked,onClick:m},[f])}}});const Ht=K({},re,{shape:String}),[Jt,Yt]=N("radio");var Xt=$({name:Jt,props:Ht,emits:["update:modelValue"],setup(e,{emit:n,slots:r}){const{parent:a}=oe(Pe),i=()=>(a?a.props.modelValue:e.modelValue)===e.name,o=()=>{a?a.updateValue(e.name):n("update:modelValue",e.name)};return()=>l(Ee,F({bem:Yt,role:"radio",parent:a,checked:i(),onToggle:o},e),we(r,["default","icon"]))}});const Qt=D(Xt),[Zt,pt]=N("checkbox"),en=K({},re,{shape:String,bindGroup:Q,indeterminate:{type:Boolean,default:null}});var tn=$({name:Zt,props:en,emits:["change","update:modelValue"],setup(e,{emit:n,slots:r}){const{parent:a}=oe(Ut),i=g=>{const{name:c}=e,{max:m,modelValue:u}=a.props,k=u.slice();if(g)!(m&&k.length>=+m)&&!k.includes(c)&&(k.push(c),e.bindGroup&&a.updateValue(k));else{const f=k.indexOf(c);f!==-1&&(k.splice(f,1),e.bindGroup&&a.updateValue(k))}},o=I(()=>a&&e.bindGroup?a.props.modelValue.indexOf(e.name)!==-1:!!e.modelValue),b=(g=!o.value)=>{a&&e.bindGroup?i(g):n("update:modelValue",g),e.indeterminate!==null&&n("change",g)};return ie(()=>e.modelValue,g=>{e.indeterminate===null&&n("change",g)}),ye({toggle:b,props:e,checked:o}),Ve(()=>e.modelValue),()=>l(Ee,F({bem:pt,role:"checkbox",parent:a,checked:o.value,onToggle:b},e),we(r,["default","icon"]))}});const nn=D(tn),[an,_e]=N("cell-group"),ln={title:String,inset:Boolean,border:Q};var on=$({name:an,inheritAttrs:!1,props:ln,setup(e,{slots:n,attrs:r}){const a=()=>{var o;return l("div",F({class:[_e({inset:e.inset}),{[gt]:e.border&&!e.inset}]},r,mt()),[(o=n.default)==null?void 0:o.call(n)])},i=()=>l("div",{class:_e("title",{inset:e.inset})},[n.title?n.title():e.title]);return()=>e.title||n.title?l(le,null,[i(),a()]):a()}});const rn=D(on),cn={name:"JpLearnSetOption",setup(){const e=L(1),n=L(1),r=L(1),a=L(!1),i=L(wt),o=L({}),b=ht();return Se(()=>{b.query.kanaType&&(e.value=Number(b.query.kanaType)),b.query.rowNum&&(n.value=Number(b.query.rowNum)),b.query.quesType&&(r.value=Number(b.query.quesType)),b.query.rowIndex&&b.query.rowIndex.split(",").forEach(u=>{u=Number(u),o.value[u]=!0})}),{kanaType:e,rowNum:n,obfuscation:a,kanaList:i,quesType:r,selectRow:o,goLearn:()=>{let m=[];if(Object.keys(o.value).forEach(_=>{o.value[_]&&m.push(Number(_))}),m.length===0){ne.showTips("请选择行");return}let u=0;if(m.forEach(_=>{i.value[_].forEach(y=>{y.Hiragana&&(u+=1)})}),u<4&&r.value===1){ne.showTips("听音模式请选择大于4个假名");return}let k=m.join(","),f="/JpLearnTY";r.value===2&&(f="/JpLearnTX"),he.push({query:{kanaType:e.value,quesType:r.value,rowIndex:k}}),ne.showTips("跳转中...","loading"),setTimeout(()=>{he.push({path:f,query:{kanaType:e.value,rowIndex:k}})},800)},changeSelectRow:m=>{o.value[m]=!o.value[m]}}}},ce=e=>(yt("data-v-ec81e411"),e=e(),St(),e),sn={class:"JpLearnSetOption"},un=ce(()=>W("div",{class:"form-title"},"类型选择",-1)),dn=ce(()=>W("div",{class:"form-title"},"题型",-1)),fn=ce(()=>W("div",{class:"form-title"},"行选择",-1)),mn={class:"kana-list"},gn={class:"show-kana"};function bn(e,n,r,a,i,o){const b=xt,g=Qt,c=Ie,m=rn,u=Wt,k=Ct,f=Vt,_=nn,y=Dt,S=vt;return X(),te("div",sn,[l(b,{title:"假名闯关设置"}),un,l(u,{modelValue:a.kanaType,"onUpdate:modelValue":n[2]||(n[2]=v=>a.kanaType=v)},{default:w(()=>[l(m,{inset:""},{default:w(()=>[l(c,{title:"平假",clickable:"",onClick:n[0]||(n[0]=v=>a.kanaType=1)},{"right-icon":w(()=>[l(g,{name:1})]),_:1}),l(c,{title:"片假",clickable:"",onClick:n[1]||(n[1]=v=>a.kanaType=2)},{"right-icon":w(()=>[l(g,{name:2})]),_:1})]),_:1})]),_:1},8,["modelValue"]),dn,l(u,{modelValue:a.quesType,"onUpdate:modelValue":n[5]||(n[5]=v=>a.quesType=v)},{default:w(()=>[l(m,{inset:""},{default:w(()=>[l(c,{title:"听音",clickable:"",onClick:n[3]||(n[3]=v=>a.quesType=1)},{"right-icon":w(()=>[l(g,{name:1})]),_:1}),l(c,{title:"听写",clickable:"",onClick:n[4]||(n[4]=v=>a.quesType=2)},{"right-icon":w(()=>[l(g,{name:2})]),_:1})]),_:1})]),_:1},8,["modelValue"]),fn,l(m,{inset:""},{default:w(()=>[(X(),te(le,null,be([0,1,2,3,4,5,6,7,8,9,10],v=>l(y,null,{extra:w(()=>[W("div",mn,[l(f,{gutter:"28",justify:"space-between"},{default:w(()=>[(X(!0),te(le,null,be(a.kanaList[v],V=>(X(),kt(k,null,{default:w(()=>[W("div",gn,_t(a.kanaType===1?V.Hiragana:V.Katakana),1)]),_:2},1024))),256))]),_:2},1024),l(_,{modelValue:a.selectRow[v],"onUpdate:modelValue":V=>a.selectRow[v]=V},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)),64))]),_:1}),l(S,{round:"",type:"success",size:"large",onClick:a.goLearn,class:"lock-to-bottom"},{default:w(()=>[Ce("Go!")]),_:1},8,["onClick"])])}const _n=bt(cn,[["render",bn],["__scopeId","data-v-ec81e411"]]);export{_n as default};
