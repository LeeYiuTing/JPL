import{_ as v,a0 as g,$ as r,V as h,W as _,a as i,a3 as l,a4 as p,X as c,a8 as x,S as w,Y as N,M as T,a5 as K,a6 as I,a7 as b,a1 as A}from"./index-068e6b32.js";import{P as C}from"./index-5ef38513.js";import{k as B,N as E}from"./kana-5c458dba.js";const S={name:"JpLearnTY",data(){return{kanaList:B,randomKanaList:[],audioPlayer:new Audio,target:{},rangeList:[],kanaType:0,rowNum:0,learnNum:0,kanaIndex:0}},mounted(){let t=this.$route.query;console.log("query",t),this.rowNum=Number(t.rowNum),this.kanaType=Number(t.kanaType),this.learnNum=5*this.rowNum;let a=t.rowIndex.split(","),e=[];a.forEach(s=>{s=Number(s),e.push(this.kanaList[s])}),this.kanaList=e,this.collectKana()},methods:{router(){return g},collectKana(){let t=this.kanaList,a=[];t.slice(0,this.rowNum).forEach(s=>{s.forEach(n=>{n.Hiragana&&a.push(n)})}),console.log(this.kanaType),a.forEach(s=>{this.kanaType===1||this.kanaType===3?s.kana=s.Hiragana:this.kanaType===2&&(s.kana=s.Katakana)}),a=r.shuffleArray(a),this.rangeList=a,this.next()},randomGetFourKana(){let{rangeList:t,target:a}=this,e=[];e.push(a);let s=()=>{let o=Math.floor(Math.random()*t.length);return t[o]},n=()=>{let o=s();e.includes(o)?n():e.push(o)};for(;e.length<4;)n();return e},next(){let{randomKanaList:t,rangeList:a,kanaIndex:e,learnNum:s}=this;e>=a.length?(console.log("全部完成"),this.kanaIndex+=1,r.showTips("全部完成 !","success"),setTimeout(()=>{g.back()},1e3)):(this.target=a[e],this.kanaIndex=e+1,t=this.randomGetFourKana(),this.randomKanaList=r.shuffleArray(t),this.playAudio())},playAudio(){let{audioPlayer:t,target:a}=this;t.src=a.audio,t.play().catch(e=>{r.showTips("首次请手动点击播放","success")})},clickKana(t){let{target:a}=this;t.Hiragana===a.Hiragana?(r.showNotify("回答正确","success"),r.showTips("前往下一个 !","loading"),setTimeout(()=>{this.next()},800)):(r.showTips("答错咯","fail"),this.playAudio())}}},u=t=>(K("data-v-f86587f2"),t=t(),I(),t),F={class:"JpLearn"},H=u(()=>l("div",{class:"form-title"},null,-1)),J=u(()=>l("div",{class:"form-title"},null,-1)),P={class:"step-Line"},V=u(()=>l("div",{class:"form-title"},null,-1)),Y={class:"step-text"},q=u(()=>l("div",{class:"form-title"},null,-1)),G={class:"alias-layout"},M=["onClick"];function j(t,a,e,s,n,o){const k=E,L=C,f=b,m=x,y=A;return h(),_("div",F,[i(k,{title:"假名听音","left-text":"返回","left-arrow":"",onClickLeft:a[0]||(a[0]=d=>o.router().back())}),H,J,l("div",P,[i(L,{inactive:"",percentage:((n.kanaIndex-1)/n.rangeList.length*100).toFixed(2)},null,8,["percentage"])]),V,l("div",Y,p(n.kanaIndex>n.rangeList.length?n.rangeList.length:n.kanaIndex)+"/"+p(n.rangeList.length),1),q,i(m,{justify:"center"},{default:c(()=>[i(f,null,{default:c(()=>[l("div",G,[(h(!0),_(w,null,N(n.randomKanaList,(d,z)=>(h(),_("div",{class:"alias-text",onClick:D=>o.clickKana(d)},p(d.kana),9,M))),256))])]),_:1})]),_:1}),i(m,{class:"lock-to-bottom",justify:"center",gutter:"100"},{default:c(()=>[i(f,{onClick:o.playAudio},{default:c(()=>[i(y,{round:"",type:"success",size:"large",class:"lock-to-bottom"},{default:c(()=>[T("重听")]),_:1})]),_:1},8,["onClick"])]),_:1})])}const O=v(S,[["render",j],["__scopeId","data-v-f86587f2"]]);export{O as default};
